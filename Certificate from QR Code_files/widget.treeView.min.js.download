/*!
 UI tree view widget
 Copyright (c) 2010, 2024, Oracle and/or its affiliates.
 */
!function(e,t,i,n,s){"use strict";const o="a-TreeView",r="a-TreeView-node",l="."+r,a="a-TreeView-row",d="."+a,h="a-TreeView-content",c="."+h,p=c+", "+d,f="a-TreeView-toggle",u="."+f,g="a-TreeView-placeholder",m="u-selector",v="."+m,_="is-selected",w="."+_,b="is-disabled",y="."+b,C="is-focused",x="is-hover",N="is-expandable",I="is-collapsible",S="is-processing",k="a-TreeView-node--leaf",A="u-RTL",P="a-TreeView-input",T="."+P,D=":visible",E="class",O="aria-expanded",M="aria-selected",R="aria-disabled",V="aria-level",L="aria-owns",F="is-active",H="tree",K="treeitem",$="none",B="<ul role='group'>",W="</ul>",q="true",j="false",X="#action$",Y="_subtree",U="selectionChange",z=/>$/,G=s.ui.keyCode,Q=s.extend,Z=t.hasOwnProperty,J=e=>parseInt(e,10);function ee(){return new Error("Unsupported by model")}function te(){return new Error("Parent node required")}function ie(e,t){let i="",n=e.className.split(" ");for(let e=0;e<n.length;e++){let o=n[e];s.inArray(o,t)>=0&&(i+=" "+o)}e.className=i.substr(1)}function ne(e){return e.parent().children(D).index(e)}function se(e){let t=e.get(0).id;return t.substring(t.lastIndexOf("_")+1)}function oe(e,t){return J(e.children(c).find(t).attr(V))}function re(e,t){return J(e.find(t).attr(V))}let le=null;function ae(e,t,i,n,s){if(i.renderNodeContent)i.renderNodeContent(t,e,n,s);else{let o,r,l,a,d;n.nodeSelector>0&&(a=m,1===n.nodeSelector&&(a+=" u-selector--single"),e.markup('<span class="'+a+'"></span>')),i.getIcon&&(o=i.getIcon(t),null!==o&&e.markup("<span").attr(E,n.iconType+" "+o).attr("aria-hidden","true").markup("></span>")),r=n.useLinks&&i.getLink&&i.getLink(t),r&&r.startsWith(X)&&(d=r.substring(8),r=null),r?(le&&r.match(/^#\S*$/)&&(r=le+r),l="a"):l="span",e.markup("<"+l+" tabIndex='-1' role='"+K+"'").attr(E,n.labelClass+(t.current?" is-current":"")).optionalAttr("href",r).optionalAttr("data-action",d).attr(V,s.level).attr(M,s.selected?q:j).optionalAttr("aria-current",t.current).optionalAttr(R,s.disabled?q:null).optionalAttr(O,!1===s.hasChildren?null:s.expanded?q:j).optionalAttr(L,s.owns).markup(">").content(i.getLabel(t)).markup("</"+l+">")}}function de(e){e.tabIndex=0,e.focus()}function he(e){let t;return e.hasClass(I)&&(t=e.children("ul").children("li").filter(D).first()),t&&t[0]||(t=e.nextAll(D).first(),0===t.length&&(t=e.parent().parents("li").nextAll("li").filter(D).first())),t}function ce(e){let t;if(t=e.prevAll(D).first(),t.length>0){if(t.hasClass(I)){let e=t.find("li").filter(D).last();e[0]&&(t=e)}}else t=e.parent().parent("li");return t}function pe(e,t,i,n,o){var r=e.val(t).width(i).keydown((function(e){var t=e.which;e.shiftKey||e.ctrlKey||e.altKey||(t===G.ENTER?(n(s(this).val(),!0),e.preventDefault()):t===G.ESCAPE&&(setTimeout((function(){o(!0)}),10),e.preventDefault()))})).blur((function(){n(s(this).val(),!1)}))[0];return de(r),r.select(),r}s("base").length&&(le=window.location.pathname+window.location.search);var fe={begin:function(){this.text="<ul>\r\n"},node:function(e,i,n){this.text+="<li>"+t.escapeHTML(n)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};s.widget("apex.treeView",s.ui.mouse,Q(!0,{widgetEventPrefix:"treeview",options:{getNodeAdapter:null,adapterTypesMap:null,showRoot:!0,expandRoot:!0,collapsibleRoot:!0,autoCollapse:!1,useLinks:!0,multiple:!1,nodeSelector:!1,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(){this.text=""},node:function(e,t,i){t>0&&(this.text+="\r\n"),this.text+=i},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(fe)}],idPrefix:null,iconType:"a-Icon",labelClass:"a-TreeView-label",doubleClick:!1,clickToRename:!1,keyboardRename:!1,keyboardAdd:!1,keyboardDelete:!1,tooltip:null,navigation:!1,actionsContext:null,dragAndDrop:!1,dragMultiple:!1,dragReorder:!1,dragAppendTo:"parent",dragContainment:!1,dragCursor:"auto",dragCursorAt:!1,dragHelper:null,dragOpacity:!1,dragAnimate:!1,dragExpandDelay:1200,dragScroll:!0,dragScrollSensitivity:20,dragScrollSpeed:10,dragZIndex:1e3,scope:"default",activate:null,deactivate:null,out:null,over:null,start:null,drag:null,beforeStop:null,stop:null,selectionChange:null,expansionStateChange:null,activateNode:null,beginEdit:null,endEdit:null,added:null,renamed:null,deleted:null,moved:null,copied:null},scrollTimerId:null,delayExpandTimer:null,hasCurrent:!1,tooltipOptions:null,triggerTimerId:null,forwardKey:G.RIGHT,backwardKey:G.LEFT,scrollParent:null,animating:!1,dragging:!1,dragItems:null,currentItem:null,_create:function(){let e=this,i=this.element,r=this.options;if(r.getNodeAdapter||(r.getNodeAdapter=this._parseTreeMarkup(i,r.adapterTypesMap||null)),!r.getNodeAdapter)throw new Error("Missing required option getNodeAdapter");this.actionsContext=r.actionsContext=r.actionsContext||n,this.nodeAdapter=r.getNodeAdapter(),this.nodeAdapter.setView&&this.nodeAdapter.setView(i),this.containerCache={},!1===r.collapsibleRoot&&(r.expandRoot=!0),i.addClass(o).attr("role",H),this.baseId=(r.idPrefix||i[0].id||H)+"_",this.labelSelector="."+r.labelClass,this.lazyExpandQueue=[];this._delayExpand=t.debounce((()=>{for(;this.lazyExpandQueue.length>0;){let e=this.lazyExpandQueue.shift();this._expandNode(s("#"+e),(()=>{}))}}),50),this.editMode=!1,r.multiple&&i.attr("aria-multiselectable",q),this.rtlFactor=1,"rtl"===i.css("direction")&&(i.addClass(A),this.forwardKey=G.LEFT,this.backwardKey=G.RIGHT,this.rtlFactor=-1),r.disabled&&i.attr(R,q),r.tooltip&&this._initTooltips(r.tooltip),this._initContextMenu(c,(function(t){return s(t.target).closest("a").length>0||e.editMode}),(function(t){let i="keydown"===t.type&&e.lastFocused?e.lastFocused:t.target,n=s(i).closest(c);return!!n.length&&(!!n.hasClass(_)||n)}),(function(t){t.selectedNodes=e.getNodes(t.selection),t.treeNodeAdapter=e.nodeAdapter})),this.scrollParent=i.scrollParent(),this.offset=this.element.offset(),this._mouseInit(),this._on(this._eventHandlers),r.allowCopy&&apex.clipboard.addHandler(i[0],(function(t){return!e.editMode&&(e._copy(t),!0)})),this._selNotifyDelay=t.debounce(this._selChangeNotify,1),this._selNotifyLongDelay=t.debounce(this._selChangeNotify,350),this._setOption("disabled",r.disabled),this.refresh()},_eventHandlers:{click:function(e){var t,i,n=this.options,o=s(e.target);if(n.multiple||"A"!==e.target.nodeName||!e.shiftKey&&!e.ctrlKey){if(o.hasClass(m))t=o.closest(l),e.ctrlKey=!0,e.shiftKey=!1,this._select(t.children(c),e,!0),e.preventDefault();else if(o.hasClass(f))this._toggleNode(o.parent()),this.scrollParent&&(r=this.scrollParent,a=r.scrollTop(),d=r,h=null,r[0]===document&&(d=s(window)),d.on("scroll.treeTemp",(function(){r.scrollTop(a),d.off(".treeTemp"),clearTimeout(h)})),h=setTimeout((function(){d.off(".treeTemp")}),20)),this.lastFocused.focus(),e.preventDefault();else if((t=o.closest(l)).length>0){if(i=t.children(c),this.editMode&&i.hasClass(_))return;n.clickToRename&&i.find(this.labelSelector).attr(M)===q&&!e.ctrlKey&&!e.altKey&&1===this.getSelection().length&&o.closest(this.labelSelector).length?this.renameNodeInPlace(i):(this._select(i,e,!0),n.navigation&&(this.keyboardActivate||"activate"!==n.doubleClick)&&this._activate(e,t)),e.preventDefault()}var r,a,d,h,p;this.keyboardActivate=!1,p={},window.getSelection?p=window.getSelection():document.selection&&(p=document.selection.createRange()),p.rangeCount?p.removeAllRanges():p.text>""&&document.selection.empty()}else this.keyboardActivate=!1},dblclick:function(e){var t,i=this.options.doubleClick;i&&!this.editMode&&(t=s(e.target).closest(l)).length>0&&("toggle"===i?(this._toggleNode(t),e.preventDefault()):"activate"===i&&this._activate(e,t))},keydown:function(e){var t,i,n,o,r,a=this,h=this.options,p=this.element,f=e.which;e.altKey||"INPUT"===e.target.nodeName||this.dragging||(f!==G.PAGE_UP&&f!==G.PAGE_DOWN||(this.scrollParent?(n=p.find(d).filter(D).first().outerHeight()||24,t=p.find("li").filter(D).first(),n+=J(t.css("margin-top"))+J(t.css("margin-bottom")),o=this.scrollParent[0]===document?s(window).height():this.scrollParent[0].clientHeight,r=Math.floor(o/n)-1):r=10),f===G.HOME?(p.find(c).filter(D).first().each((function(){a._select(s(this),e,!0,!0)})),e.preventDefault()):f===G.END?(p.find(c).filter(D).last().each((function(){a._select(s(this),e,!0,!0)})),e.preventDefault()):f===G.SPACE?(this.lastFocused&&this._select(s(a.lastFocused).closest(c),e,!0,!0),e.preventDefault()):f===G.DOWN?(this._traverseDown(e,1),e.preventDefault()):f===G.UP?(this._traverseUp(e,1),e.preventDefault(),e.stopPropagation()):f===G.PAGE_DOWN?(this._traverseDown(e,r),e.preventDefault()):f===G.PAGE_UP?(this._traverseUp(e,r),e.preventDefault()):f===this.backwardKey?(this.lastFocused&&((t=s(this.lastFocused).closest(l)).hasClass(I)?this._collapseNode(t):t.parent().prevAll(c).each((function(){a._select(s(this),e,!0,!0)}))),e.preventDefault()):f===this.forwardKey?(this.lastFocused&&((t=s(this.lastFocused).closest(l)).hasClass(N)?this._expandNode(t):t.hasClass(I)&&t.children("ul").children("li").first().children(c).each((function(){a._select(s(this),e,!0,!0)}))),e.preventDefault()):f===G.ENTER?"A"===e.target.nodeName||e.shiftKey||e.ctrlKey?this.keyboardActivate=!0:(t=s(this.lastFocused).closest(l),this._activate(e,t),e.preventDefault()):113===f&&h.keyboardRename?(i=this.lastFocused&&s(this.lastFocused).closest(c+w).length>0?s(this.lastFocused).closest(c):this.getSelection().first()).length>0&&this.renameNodeInPlace(i):45===f&&h.keyboardAdd?(i=this.lastFocused&&s(this.lastFocused).closest(c+w).length>0?s(this.lastFocused).closest(c):this.getSelection().first()).length>0&&this.addNodeInPlace(i):f===G.DELETE&&h.keyboardDelete&&this.deleteNodes(this.getSelection()))},keypress:function(e){var t,i,n=this;if(!(0===e.which||e.ctrlKey||e.altKey||"INPUT"===e.target.nodeName||this.dragging)){if(t=String.fromCharCode(e.which).toLowerCase(),this.searchTimerId)t!==this.searchString&&(this.searchString+=t),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===t)return;this.searchString=t}this.searchTimerId=setTimeout((function(){n.searchTimerId=null}),500),(i=function(e){var t,i,o,r=e.length;function a(){0===(i=he(i)).length&&(i=n.element.find(l).filter(D).first())}for(i=t=s(n.lastFocused).closest(l),1===r&&a();;){if((o=i.children(c).find(n.labelSelector).first()).text().substring(0,r).toLowerCase()===e)return o.closest(c);if(a(),i[0]===t[0])break}return null}(this.searchString))&&this._select(i,e,!0,!0)}},focusin:function(e){var t=s(e.target).closest(this.labelSelector);t.length&&(t.addClass(C).closest(l).children(d).addClass(C),this._setFocusable(t))},focusout:function(e){s(e.target).closest(this.labelSelector).removeClass(C).closest(l).children(d).removeClass(C)},mousemove:function(e){var t;this.dragging||(t=s(e.target).closest(l)).length&&this.lastHover!==t[0]&&(s(this.lastHover).children(p).removeClass(x),t.children(p).addClass(x),this.lastHover=t[0])},mouseleave:function(){this.dragging||this.lastHover&&(s(this.lastHover).children(p).removeClass(x),this.lastHover=null)}},_setOption:function(e,t){let o,r=this.options,l=r.nodeSelector;if(this._checkContextMenuOptions(e,t),"disabled"===e)r[e]=t,this.widget().toggleClass(b,!!t),t?(this.element.attr(R,q),this.lastFocused&&(this.lastFocused.tabIndex=-1),this.lastFocused=null):(this.element.removeAttr(R),o=this.getSelection().first().find(this.labelSelector),o.length||(o=this.element.find(this.labelSelector).first()),this._setFocusable(o));else{if("allowCopy"===e)throw new Error("TreeView "+e+" cannot be set");if("dragMultiple"===e&&t&&!r.multiple)throw new Error("TreeView dragMultiple cannot be true when the multiple option is false");if("multiple"===e&&!t&&r.dragMultiple)throw new Error("TreeView multiple cannot be false when the dragMultiple option is true");if("collapsibleRoot"===e)throw new Error("TreeView collapsibleRoot option cannot be set");this._super(e,t)}r=this.options,r.multiple&&!r.nodeSelector&&apex.userHasTouched()&&(r.nodeSelector=!0),this.renderNodeOptions={iconType:r.iconType,labelClass:r.labelClass,useLinks:r.useLinks,nodeSelector:r.nodeSelector?r.multiple?2:1:0},"showRoot"===e||"useLinks"===e||r.nodeSelector!==l||"multiple"===e&&r.nodeSelector?this.refresh():"getNodeAdapter"===e?(this.nodeAdapter=r.getNodeAdapter(),this.refresh()):"multiple"===e?(this.element.attr("aria-multiselectable",t?q:j),!1===t&&this.getSelection().length>0&&this._select(s(this.lastFocused).closest(c),null,!1,!1)):"expandRoot"===e&&!1===t?!1===r.collapsibleRoot&&(r.expandRoot=!0,i.warn("ExpandRoot option cannot be false when collapsibleRoot is false")):"tooltip"===e?this._initTooltips(t):"actionsContext"===e&&(this.actionsContext=t||n)},_initTooltips:function(e){var t,n=this;s.ui.tooltip?(this.tooltipOptions&&(this.element.tooltip("destroy"),this.tooltipOptions=null),e&&((t=this.tooltipOptions=Q(!0,{},e)).items=this.labelSelector,t.content&&"function"==typeof t.content&&(t._originalContent=t.content,t.content=function(e){var i=n.getNodes(s(this).closest(c))[0];return t._originalContent.call(this,e,i)}),this.element.tooltip(t))):i.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var e=this.element;e.empty().removeClass(o+" "+A).removeAttr("role").removeAttr("aria-multiselectable"),apex.clipboard.removeHandler(e[0]),this._destroyContextMenu(),this.options.tooltip&&s.ui.tooltip&&e.tooltip("destroy"),this._mouseDestroy()},refresh:function(e){let i,n,o,r=this,a=this.options,d=this.nodeAdapter,h=null,c=this.element,p=t.htmlBuilder();const f=()=>{h&&h.length>0?this.setSelectedNodes(h,!1,!0):(this.selectAnchor=this.lastFocused,this._setFocusable(c.find(this.labelSelector).first()))};if(d.getViewId&&this.treeMap&&(h=this.getSelectedNodes()),e)e.each((function(){var e=s(this).parent(),t=r.treeMap[se(e)];e.find(l).addBack().each((function(){delete r.treeMap[se(s(this))]})),p.clear(),r._renderNode(t,oe(e,r.labelSelector),p),e.replaceWith(p.toString())}));else{if(this.treeMap={},this.nextNodeId=0,d.clearViewId&&d.clearViewId(this.baseId),i=d.root(),i)p.markup(B),a.showRoot?this._renderNode(i,1,p):d.hasChildren(i)&&this._renderChildren(i,1,p),p.markup(W),c.html(p.toString());else if(p.markup(B),p.markup(W),c.html(p.toString()),d.fetchChildNodes&&d.modelId)return void d.fetchChildNodes(null,(()=>{f()}));a.expandRoot&&a.showRoot&&(n=this._getRoots(),n.length>0&&this._expandNode(n))}this.hasCurrent?(o=this.find({depth:-1,match:function(e){return!0===e.current}}),this.hasCurrent=!1,this.setSelection(o)):f()},getNodeAdapter:function(){return this.nodeAdapter},focus:function(){this.lastFocused&&this.lastFocused.focus()},getTreeNode:function(e){var t,i=this.nodeAdapter;if(!i.getViewId)throw ee();return t=i.getViewId(this.baseId,e),s("#"+this.baseId+t).children(c)},getSelection:function(){return this.element.find(c+w)},getNodes:function(e){var t=this,i=[];return e.each((function(){var e=se(s(this).closest("li"));"new"!==e&&i.push(t.treeMap[e])})),i},getSelectedNodes:function(){return this.getNodes(this.getSelection())},setSelection:function(e,t,i){t=!!t,this.options.multiple||(e=e.first()),this._select(e,null,t,!1,i)},setSelectedNodes:function(e,t,n){var o,r,l,a=[],d=this.nodeAdapter;if(!d.getViewId)throw ee();for(t=!!t,this.options.multiple||(e=[e[0]]),o=0;o<e.length;o++)r=d.getViewId(this.baseId,e[o]),(l=s("#"+this.baseId+r).children(c)[0])?a.push(l):i.warn("TreeView: Ignoring bad node in setSelectedNodes");this._select(s(a),null,t,!1,n)},getExpandedNodeIds:function(){var e=this.nodeAdapter;if(!e.getExpandedNodeIds)throw ee();return e.getExpandedNodeIds(this.baseId)},getExpandedState:function(){var e=this.nodeAdapter;if(!e.getExpandedState)throw ee();return e.getExpandedState(this.baseId)},find:function(e){return s(this._find(e.parentNodeContent$||null,e.match,e.depth||1,e.findAll||!1))},expand:function(e){var t=this;e||(e=this._getRoots().children(c)),e.each((function(){var e=s(this).closest(l);e.hasClass(N)&&t._expandNode(e)}))},expandAll:function(e){var t=this;e||(e=this._getRoots().children(c)),e.each((function(){var e=s(this).closest(l);e.hasClass(N)?t._expandNode(e,(function(){t.expandAll(e.children("ul").children("li").children(c))})):t.expandAll(e.children("ul").children("li").children(c))}))},collapse:function(e){var t=this;e||(e=this._getRoots().children(c)),e.each((function(){var e=s(this).closest(l);e.hasClass(I)&&t._collapseNode(e)}))},collapseAll:function(e){var t=this;e||(e=this._getRoots().children(c)),e.each((function(){var e=s(this).closest(l);t.collapseAll(e.children("ul").children("li").children(c)),e.hasClass(I)&&t._collapseNode(e)}))},addNodeInPlace:function(e,i,n){var o,l,d,p,f=this,u=this.element,g=this.options,m=this.nodeAdapter,v=!1;function w(t){l.remove(),f._makeLeafIfNeeded(e),f._select(e,null,t),f._endEdit({action:"add",status:"cancel"})}function b(s,r){var a;v||(0!==s.length?(v=!0,m.addNode(d,o.children().length-1,s,n,(function(n,s){var h,u;if(!1===n)return v=!1,de(a=l.find(T).val(i).get(0)),void a.select();n?(l.remove(),u=t.htmlBuilder(),f._renderNode(n,p,u),s>=o.children("li").length?o.append(u.toString()):o.children("li").eq(s).before(u.toString()),h=o.children("li").eq(s),0===f.getSelection().length&&f._select(h.children(c),null,r),f._endEdit({action:"add",status:"complete"}),f._trigger("added",{},{parentNode:d,parent$:e,index:s,node:n,node$:h.children(c)})):w(r)}))):w(r))}function y(){var e,d,u,v=t.htmlBuilder(),y=f.baseId+"new";v.markup("<li").attr("id",y).attr(E,r+" "+k).markup("><div").attr(E,a+" "+_).markup("></div><div").attr(E,h+" "+_).markup(">"),m.getIcon&&v.markup("<span").attr(E,g.iconType).markup("></span>"),v.markup("<span role='"+K+"'").attr(E,g.labelClass).attr(V,p).attr(M,q).markup("><input class='"+P+"' type='text'></span></div></li>"),f._select(s(),null,!1),o.append(v.toString()),d=(l=o.find("#"+y)).children(c),e=1===f.rtlFactor?d.width()-d.find(f.labelSelector)[0].offsetLeft-16:d.find(f.labelSelector)[0].offsetLeft+d.find(f.labelSelector).width()-16,pe(u=d.find(T),i,e,b,w),f._beginEdit({action:"add",context:n,input:u[0]})}if(!m.addNode||!m.allowAdd)throw ee();if(null===e){if(d=m.root(),!g.showRoot){if(!m.allowAdd(d,"add",n?[n]:void 0))return;return p=1,o=u.find("ul:first"),void y()}e=u.find("ul:first > li")}else d=this.treeMap[se(e.parent())];m.allowAdd(d,"add",n?[n]:void 0)&&(p=re(e,f.labelSelector)+1,f._makeParentIfNeeded(e),this._expandNode(e.parent(),(function(){o=e.next("ul");e.find(`[role="${K}"]`).attr(L,o.attr("id")),y()})))},renameNodeInPlace:function(e){var i,n,o,r,l,a,d=this,h=this.nodeAdapter,c=e.parent(),p=se(c),f=!1,u=c.children("ul").attr("id"),g=t.htmlBuilder();function m(t){a.selected=e.hasClass(_),g.clear(),ae(g,i,h,d.renderNodeOptions,a),e.html(g.toString()),a.selected&&d._select(e,null,t),d._endEdit({action:"rename",status:"cancel"})}if(!h.renameNode||!h.allowRename)throw ee();i=this.treeMap[p],h.allowRename(i)&&(l=e.find(this.labelSelector),a={level:J(l.attr(V)),selected:l.attr(M)===q,disabled:l.attr(R)===q,hasChildren:void 0!==l.attr(O),expanded:l.attr(O)===q,owns:u},o=h.getLabel(i),r=1===d.rtlFactor?e.width()-l[0].offsetLeft-16:l[0].offsetLeft+l.width()-16,n=s("<input class='"+P+"' type='text'>"),l.empty().append(n),pe(n,o,r,(function(t,n){var s;f||(f=!0,t!==o&&0!==t.length?h.renameNode(i,t,(function(t,i){var r,l,u;if(!1===t)return f=!1,de(s=e.find(T).val(o)[0]),void s.select();t?(g.clear(),a.selected=e.hasClass(_),ae(g,t,h,d.renderNodeOptions,a),e.html(g.toString()),d.treeMap[p]=t,(r=(u=(l=c.parent()).children("li")).index(c))!==i&&(i>r&&(i+=1),i>=u.length?l.append(c):u.eq(i).before(c)),a.selected&&d._select(e,null,n),d._endEdit({action:"rename",status:"complete"}),d._trigger("renamed",{},{prevLabel:o,index:i,node:t,node$:e}),d._trigger(U,0)):m(n)})):m(n))}),m),d._beginEdit({action:"rename",node:i,input:n[0]}))},deleteNodes:function(e){var t,i,n,o=this,r=[],l=[],a=[],d=this.nodeAdapter;function h(e){var t=r[e];d.deleteNode(t.node,(function(e){n+=1,e&&(l.push(t.element),a.push({node:t.node,parent$:t.parent$,index:t.index}),d.clearViewId&&d.clearViewId(o.baseId,t.node)),n>=i&&(o.deleteTreeNodes(s(l)),o._trigger("deleted",{},{items:a}))}),e<i-1)}if(!d.deleteNode||!d.allowDelete)throw ee();for(e.each((function(){var e=s(this),t=o.treeMap[se(e.parent())];d.allowDelete(t)&&r.push({node:t,element:e[0],parent$:e.parent().parent().parent().children(c),index:ne(e.parent())})})),i=r.length,n=0,t=0;t<i;t++)h(t)},deleteTreeNodes:function(e){var t,i=this,n=e.closest("ul").prev(),s=e.parent(),o=e.children(this.labelSelector).filter(this.lastFocused).length>0,r=e.hasClass(_);(r||o)&&(0===(t=ce(s.eq(0))).length&&(t=this._getRoots().first()),t.length>0?r?this._select(t.children(c),null,o):this._setFocusable(t.children(c).find(this.labelSelector)):o&&(this.lastFocused=null)),s.remove().each((function(){delete i.treeMap[se(s)]})),this._makeLeafIfNeeded(n)},addNode:function(e,t,i){var n,s,o=this.nodeAdapter;if(!o.addNode||!o.allowAdd)throw ee();if(e&&e.length)s=this.treeMap[se(e.parent())];else{if(this.options.showRoot)throw te();s=o.root()}o.allowAdd(s,"add",i?[i]:void 0)&&(n=this.element.find("."+C).length>0,this._add({},e,t,i,n))},moveNodes:function(e,t,i){var n,s,o,r=this.getNodes(i),l=!0,a=this.nodeAdapter;if(!a.moveNodes||!a.allowDelete||!a.allowAdd)throw ee();if(e&&e.length)o=this.treeMap[se(e.parent())];else{if(this.options.showRoot)throw te();o=a.root()}for(n=0;n<r.length;n++)if(!a.allowDelete(r[n])){l=!1;break}l&&a.allowAdd(o,"move",r)&&(s=this.element.find("."+C).length>0,this._moveOrCopy({},e,t,i,!1,s))},copyNodes:function(e,t,i){var n,s,o=this.getNodes(i),r=this.nodeAdapter;if(!r.copyNodes||!r.allowAdd)throw ee();if(e&&e.length)s=this.treeMap[se(e.parent())];else{if(this.options.showRoot)throw te();s=r.root()}r.allowAdd(s,"copy",o)&&(n=this.element.find("."+C).length>0,this._moveOrCopy({},e,t,i,!0,n))},update:function(e,i=!0){let n,s,o,r,l=!1,p=e.parent(),f=this.treeMap[se(p)],u=this.nodeAdapter,g=p.children("ul").attr("id"),m=t.htmlBuilder();if(s=e.find(this.labelSelector),n=s[0]===this.lastFocused,u.getClasses||u.isDisabled||u.isHidden){let t,i=e.prevAll(d);ie(e[0],[h,b,C,_,x]),ie(i[0],[a,b,C,_,x]),u.getClasses&&(t=u.getClasses(f),t&&e.add(i).addClass(t)),u.isDisabled&&(r=u.isDisabled(f),e.add(i).toggleClass(b,r)),u.isHidden&&(l=u.isHidden(f),p.toggleClass("u-hidden",l))}i&&(o={level:J(s.attr(V)),selected:s.attr(M)===q,disabled:r,hasChildren:void 0!==s.attr(O),expanded:s.attr(O)===q,owns:g},ae(m,f,u,this.renderNodeOptions,o),e.html(m.toString())),n&&(l&&(e=p.parents("li").filter(D).first().children(c)),this._setFocusable(e.find(this.labelSelector)))},_copy:function(e){var t,i,n=this.nodeAdapter,s=this.getSelectedNodes(),o=this.options.dataTransferFormats;if(s.length){for(o.forEach((function(e){e.writer.begin(n,s)})),t=0;t<s.length;t++)i=s[t],o.forEach((function(e){e.writer.node(i,t,n.getLabel(i))}));o.forEach((function(t){t.writer.end(),e.setData(t.format,t.writer.toString())}))}},_parseTreeMarkup:function(e,t){var i,n,o,r=!0,l=this;return n=function e(t){var i=[];return t.children("ul").children("li").each((function(){var t,n,o,a,d,h,c=s(this),p=c.children("a").first(),f=c.children("span").first();t={},p.length>0?(t.label=p.text(),t.link=p.attr("href"),(h=p.attr("target"))&&(t.linkTarget=h)):f.length>0&&(t.label=f.text()),(o=c.attr("data-id"))?t.id=o:r=!1,c.attr("data-current")===q&&(t.current=!0,l.hasCurrent=!0),(a=c.attr(E))&&(t.classes=a),c.attr("data-disabled")===q&&(t.isDisabled=!0),(n=c.attr("data-icon"))&&(t.icon=n),(d=c.attr("data-type"))&&(t.type=d),c.children("ul").length>0&&(t.children=e(c)),i.push(t)})),i}(e),o=n.length>=1?1===n.length&&this.options.showRoot?n[0]:{children:n}:null,t||(t={default:{operations:{canAdd:!1,canDelete:!1,canRename:!1,canDrag:!1}}}),i=s.apex.treeView.makeDefaultNodeAdapter(o,t,r),function(){return i}},_getBeginChildrenMarkup:function(e){return e?B.replace(z,` id=${e}>`):B},_renderNode:function(e,t,i){const n=this.nextNodeId;let s,o,l,d,c,p,u=!1,g=!1,m=this.options,v=this.nodeAdapter;this.treeMap[n]=e,v.setViewId&&v.setViewId(this.baseId,e,n),this.nextNodeId+=1,o=r+" ",s=v.hasChildren(e),null===s&&(g=!0,s=!0),s?(c=!1,v.isExpanded&&(c=v.isExpanded(this.baseId,e)),o+=c?I:N):o+=k,d=0===n&&m.showRoot&&!m.collapsibleRoot,d&&(o+=" a-TreeView--noCollapse"),1===t&&(o+=" a-TreeView-node--topLevel"),l=h,v.isDisabled&&v.isDisabled(e)&&(l+=" "+b,u=!0),v.isHidden&&v.isHidden(e)&&(o+=" u-hidden"),p=a;const _=this.baseId+n,w=c?`${_}${Y}`:null;if(i.markup("<li").attr("id",_).attr("role",$).attr(E,o).markup(">"),v.getClasses){let t=v.getClasses(e);t&&(l+=" "+t,p+=" "+t)}i.markup("<div").attr("role",$).attr(E,p).markup("></div>"),s&&!d&&i.markup("<span aria-hidden='true' class='"+f+"'></span>"),i.markup("<div").attr("role",$).attr(E,l).markup(">"),ae(i,e,v,this.renderNodeOptions,{level:t,selected:!1,disabled:u,hasChildren:s,expanded:c,owns:w}),i.markup("</div>"),c&&(i.markup(this._getBeginChildrenMarkup(w)),g?this._lazyExpand(_):this._renderChildren(e,t+1,i),i.markup(W)),i.markup("</li>")},_renderChildren:function(e,i,n,s,o){let r=this.nodeAdapter,l=r.childCount(e);const a=()=>{for(let t=0;t<l;t++)this._renderNode(r.child(e,t),i,n);s&&s(!0)};null===l?s&&(t.delayLinger.start(o[0].id,(function(){o.addClass(S)})),r.fetchChildNodes(e,(function(i){if(t.delayLinger.finish(o[0].id,(function(){o.removeClass(S),0===i&&s(i)})),i){if(l=r.childCount(e),l>0)return void a();i=0}!1===i&&s(i)}))):l>0?a():s&&s(0)},_getRoots:function(){return this.element.children("ul").children("li")},_find:function(e,t,i,n){var o,r,l,a=this,d=[];return e?(l=e.parent(),this._addChildrenIfNeeded(l),r=l.children("ul").children("li")):r=this._getRoots(),r.each((function(){if(o=a.treeMap[se(s(this))],t(o)&&(d.push(s(this).children(c)[0]),!n))return!1})),(n||0===d.length)&&(i>1||-1===i)&&r.each((function(){if((d=d.concat(a._find(s(this).children(c),t,-1===i?i:i-1,n))).length>0&&!n)return!1})),d},_makeParentIfNeeded:function(e){if(e&&0===e.prev(u).length){const t=e.parent(),i=t.attr("id")?t.attr("id")+Y:null;t.removeClass(k).addClass(N),e.before("<span aria-hidden='true' class='"+f+"'></span>"),e.after(this._getBeginChildrenMarkup(i)+W),t.children("ul").hide()}},_makeLeafIfNeeded:function(e){var t=this,i=this.nodeAdapter;e.each((function(){var e,n,o=s(this);0===o.next("ul").find("li").length&&((n=o.parent()).hasClass(I)&&i.setExpanded&&(e=t.treeMap[se(n)],i.setExpanded(t.baseId,e,!1)),o.parent().removeClass(N+" "+I).addClass(k),o.find(t.labelSelector).removeAttr(O).removeAttr(L),o.prev(u).remove(),o.next("ul").remove())}))},_addChildrenIfNeeded:function(e){const i=e.attr("id"),n=i?`${i}${Y}`:null;let s,o=this.treeMap[se(e)];e.children("ul").length>0||e.hasClass(k)||(s=t.htmlBuilder(),s.markup(this._getBeginChildrenMarkup(n)),this._renderChildren(o,oe(e,this.labelSelector)+1,s),s.markup(W),e.append(s.toString()).children("ul").hide())},_toggleNode:function(e){e.hasClass(N)?this._expandNode(e):this._collapseNode(e)},_persistExpansionState:function(e,t,i){var n=this.nodeAdapter;n.setExpanded&&n.setExpanded(this.baseId,e,i),this._trigger("expansionStateChange",{},{node:e,nodeContent$:t.children(c),expanded:i})},_lazyExpand:function(e){this.lazyExpandQueue.push(e),this._delayExpand()},_expandNode:function(e,i){const n=e.attr("id"),o=n?`${n}${Y}`:null;let r,l,a=this,d=this.nodeAdapter,h=this.treeMap[se(e)];this.options.autoCollapse&&e.parent().children("."+I).each((function(){a._collapseNode(s(this))})),e.removeClass(N),r=e.children("ul"),r.length>0&&null!==d.childCount(h)?(r.show(),e.addClass(I).children(c).find(this.labelSelector).attr(O,q).attr(L,o),this._persistExpansionState(h,e,!0),i&&i()):(r.remove(),l=t.htmlBuilder(),l.markup(this._getBeginChildrenMarkup(o)),this._renderChildren(h,oe(e,this.labelSelector)+1,l,(function(t){t?(e.addClass(I).children(c).find(a.labelSelector).attr(O,q).attr(L,o),l.markup(W),e.append(l.toString()),a._persistExpansionState(h,e,!0)):0===t?(e.children(u).remove(),e.addClass(k).children(c).find(a.labelSelector).removeAttr(O).removeAttr(L)):(e.addClass(N).children(c).find(a.labelSelector).attr(O,j),a._persistExpansionState(h,e,!1)),i&&i()}),e))},_collapseNode:function(e){var t=this.options;t.showRoot&&!t.collapsibleRoot&&e.parent().parent().hasClass(o)||(e.removeClass(I).addClass(N).children(c).find(this.labelSelector).attr(O,j),e.find(w).length>0&&this._select(e.children(c),null,!0),e.children("ul").hide(),this._persistExpansionState(this.treeMap[se(e)],e,!1))},_traverseDown:function(e,t){if(this.lastFocused){let i=s(this.lastFocused).closest(l);for(let e=0;e<t;e++){let e=he(i);if(0===e.length)break;i=e}i.length>0&&this._select(i.children(c),e,!0,!0)}},_traverseUp:function(e,t){if(this.lastFocused){let i=s(this.lastFocused).closest(l);for(let e=0;e<t;e++){let e=ce(i);if(0===e.length)break;i=e}i.length>0&&this._select(i.children(c),e,!0,!0)}},_activate:function(e,t){const s=this.options,o=this.nodeAdapter;let r,l,a=this.getSelectedNodes();if(0!==a.length&&(this._trigger("activateNode",e,{nodes:a}),s.navigation&&o.getLink&&!e.isDefaultPrevented()&&(r=o.getLink(a[0]),r)))if(r.startsWith(X)){let s=n.parseActionBinding(r,!0);if(s){let o=s.contextId,r=this.actionsContext;o&&(r=n.findContextById(o),r||(i.error("No such context '"+o+"'"),r=null)),r&&r.invoke(s.actionName,e,t,s.args)}}else l=o.getLinkTarget&&o.getLinkTarget(a[0]),l?apex.navigation.openInNewWindow(r,l,{favorTabbedBrowsing:!0,noopener:!0}):apex.navigation.redirect(r)},_select:function(e,i,n,o,r){var a,h,p,f,u,g,m,C,x=e,I="set",S=this,k=this.element,A=k.find(c+w);if(i&&this.options.multiple&&("click"===i.type?i.ctrlKey||i.metaKey?I="toggle":i.shiftKey&&(I="range"):"keydown"===i.type&&(i.keyCode===s.ui.keyCode.SPACE?I=i.ctrlKey?"toggle":i.shiftKey?"range":"add":i.ctrlKey?I="none":i.shiftKey&&(I="range"))),"range"!==I||this.selectAnchor||(I="set"),"set"!==I&&"range"!==I||(A.prevAll(d).addBack().find(v).addBack().removeClass(_),A.find(this.labelSelector).attr(M,j)),h=e.eq(0).find(this.labelSelector),f=(e=e.not(y)).hasClass(_),"set"===I||"add"===I||"toggle"===I&&!f)e.prevAll(d).addBack().find(v).addBack().addClass(_),e.find(this.labelSelector).attr(M,q),e.parent().parents(l).each((function(){(a=s(this)).hasClass(N)&&S._expandNode(a)})),this.selectAnchor=e[0];else if("range"===I){for(p=s("#"+this.selectAnchor.parentNode.id+", #"+x[0].parentNode.id),a=p.first();a.children(c).hasClass(b)||(a.children(c).prevAll(d).addBack().find(v).addBack().addClass(_),a.children(c).find(this.labelSelector).attr(M,q)),0!==(a=he(a)).length&&1!==p.length&&a[0]!==p[1];);a.length>0&&2===p.length&&!a.children(c).hasClass(b)&&(a.children(c).prevAll(d).addBack().find(v).addBack().addClass(_),a.children(c).find(this.labelSelector).attr(M,q))}else"toggle"===I&&f&&(e.prevAll(d).addBack().find(v).addBack().removeClass(_),e.find(this.labelSelector).attr(M,j),this.selectAnchor=e[0]);h.length&&(n?de(h[0]):this._setFocusable(h),this.scrollParent&&(u=this.scrollParent[0],(C=h.parent().offset())&&(m=k.offset(),u===document?(g={top:s(document).scrollTop(),left:s(document).scrollLeft()},(C.top<g.top||C.top>g.top+s(window).height())&&s(document).scrollTop(C.top-m.top),(C.left+h.parent()[0].offsetWidth<g.left||C.left>g.left+s(window).width())&&s(document).scrollLeft(C.left-m.left)):(g=this.scrollParent.offset(),m=k.offset(),(C.top<g.top||C.top>g.top+u.offsetHeight)&&(u.scrollTop=C.top-m.top),(C.left+h.parent()[0].offsetWidth<g.left||C.left>g.left+u.offsetWidth)&&(u.scrollLeft=C.left-m.left))))),r||("toggle"===I||"range"===I&&!f||"add"===I&&!f||"set"===I&&!t.arrayEqual(A,e))&&(o?S._selNotifyLongDelay(i):S._selNotifyDelay(i))},_selChangeNotify:function(e){this.element.hasClass(o)&&this._trigger(U,e)},_setFocusable:function(e){var t=e[0];t&&(this.lastFocused&&this.lastFocused!==t&&(this.lastFocused.tabIndex=-1),t.tabIndex=0,this.lastFocused=t)},_beginEdit:function(e){this.editMode=!0,apex.tooltipManager&&apex.tooltipManager.disableTooltips(),this._trigger("beginEdit",{},e)},_endEdit:function(e){this.editMode=!1,apex.tooltipManager&&apex.tooltipManager.enableTooltips(),this._trigger("endEdit",{},e)},_mouseCapture:function(e,t){var i,n,o,r=!0,a=this.options;if(e.preventDefault(),this.animating||a.disabled||!a.dragAndDrop||s(e.target).hasClass(f))return!1;if(0===(n=s(e.target).closest(l).children(c)).length)return!1;if(a.dragMultiple&&(n.hasClass(_)?n=this.getSelection():e.ctrlKey&&(n=n.add(this.getSelection()))),!0!==t){for(o=this.getNodes(n),i=0;i<o.length;i++)if(!this.nodeAdapter.allowDrag||!this.nodeAdapter.allowDrag(o[i])){r=!1;break}if(!r)return!1}return this.dragItems=n,!0},_mouseStart:function(e,t,i){var n,o,r=null,l=this.options,a=this;return i||(s("body").on("keydown.treeview",(function(e){e.keyCode!==s.ui.keyCode.ESCAPE?a._dragCopyOrMove(e,!0):a._cancel(e)})).on("keyup.treeview",(function(e){a._dragCopyOrMove(e,!0)})),this._select(this.dragItems,null,!0,!1)),this.helper||(this.helper=this._createHelper(t)),this.margins={left:J(this.dragItems.css("marginLeft"))||0,top:J(this.dragItems.css("marginTop"))||0},this.offset=this.dragItems.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},Q(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset()}),this.helper.css("position","absolute"),this._cacheHelperProportions(),s.ui.ddmanager&&!i&&(this.currentItem=this.dragItems.first(),s.ui.ddmanager.current=this,s.ui.ddmanager.prepareOffsets(this,e)),this.originalPosition=this._generatePosition(t),l.dragCursorAt&&this._adjustOffsetFromHelper(l.dragCursorAt),this.dragItems&&this.dragItems.length>0&&!this.isOver&&((r=this.getNodes(this.dragItems))[0]||(r=null)),this.nodeAdapter.dragOperations?this.dragOperations=this.nodeAdapter.dragOperations(r):this.dragOperations=r?{normal:"move",ctrl:"copy"}:{normal:"add"},this.dragOperation=this.dragOperations.normal,this.dragging=!0,this.lastHover&&(s(this.lastHover).children(p).removeClass(x),this.lastHover=null),l.dragReorder&&(o=this.dragItems.first().outerHeight(),"move"===this.dragOperation&&this.dragItems.parent().hide(),this._createPlaceholder(o),this.initialPlaceholderPos=null),this._initPositions(),this._refreshPositions(),l.dragContainment&&this._setContainment(),i||l.dragCursor&&"auto"!==l.dragCursor&&(n=this.document.find("body"),this.storedCursor=n.css("cursor"),n.css("cursor",l.dragCursor),this.storedStylesheet=s("<style>*{ cursor: "+l.dragCursor+" !important; }</style>").appendTo(n)),l.dragOpacity&&this.helper.css("opacity",l.dragOpacity),l.dragZIndex&&this.helper.css("zIndex",l.dragZIndex),this.helper.addClass("a-TreeView-dragHelper"),this.scrollParent&&this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset(),this.originalScroll={top:this.scrollParent[0].scrollTop,left:this.scrollParent[0].scrollLeft}),apex.tooltipManager&&apex.tooltipManager.disableTooltips(),this._trigger("start",t,this._uiHashDnD()),this._mouseDrag(t),s.ui.ddmanager&&!i&&s.ui.ddmanager.dragStart(this,t),!0},_mouseDrag:function(e){var t={pageX:e.pageX,pageY:e.pageY};return this.position=this._generatePosition(e),this.positionAbs=this._adjustPositionForScroll(),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.dragEventTarget=e.target,this.options.dragScroll&&(this._scrollCheck(t)?this.scrollTimerId||this._scrollStart(t):this.scrollTimerId&&this._scrollStop()),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",this._dragCopyOrMove(e),this._dragHitCheck(),s.ui.ddmanager&&!this.isOver&&s.ui.ddmanager.drag(this,e),this._trigger("drag",e,this._uiHashDnD()),this.lastPositionAbs=this.positionAbs,!1},_dragHitCheck:function(){var e,t,i,n,o,r,l,a,h,p=this,f=0,u=null,m=this.dropTargetNode?this.dropTargetNode[0].id:null,v=this.options;if(this.scrollParent[0]!==document&&(f=this.scrollParent[0].scrollTop-this.dropPositionsOrigin),(i=this.positionAbs.left+this.offset.click.left)>this.containerCache.left&&i<this.containerCache.left+this.containerCache.width)if(this.placeholder&&s(this.dragEventTarget).closest("."+g).length)null===this.initialPlaceholderPos&&(this.initialPlaceholderPos=i),(a=(i-this.initialPlaceholderPos)*this.rtlFactor)>(this.options.dragScrollSensitivity||10)?(this.initialPlaceholderPos=i,this._movePlaceholder({element:this.placeholder.children(c)},"below")):a<(-this.options.dragScrollSensitivity||-10)&&(this.initialPlaceholderPos=i,this._movePlaceholder({element:this.placeholder.children(c)},"above"));else for(this.initialPlaceholderPos=null,n=this.positionAbs.top+this.offset.click.top+f,e=0;e<this.dropPositions.length;e++)if(n>=(t=this.dropPositions[e]).top&&n<=t.bottom){u=t.nodeId,r=n>t.top+(t.bottom-t.top)/2?"bottom":"top";break}m===u&&r===this.lastLocation||(p.delayExpandTimer&&(clearTimeout(p.delayExpandTimer),p.delayExpandTimer=null),this.element.find("."+F).removeClass(F),u?(o=s("#"+u),v.dragExpandDelay>=0&&o.hasClass(N)&&(this.delayExpandTimer=setTimeout((function(){p.delayExpandTimer=null,p._expandNode(o,(function(){p._initPositions(o),p._refreshPositions()}))}),v.dragExpandDelay)),t.canAdd?(this.dropTargetNode=o,this.placeholder?(l=0!==(h=p.positionAbs.top-p.lastPositionAbs.top)&&(h>0?"down":"up"),"top"===r&&"up"===l?this._movePlaceholder(t,"before"):"bottom"===r&&"down"===l&&(t.canAddChild?(this.initialPlaceholderPos=i,this._movePlaceholder(t,"after"),this._movePlaceholder({element:this.placeholder.children(c)},"below")):this._movePlaceholder(t,"after"))):this.dropTargetNode.children(c+","+d).addClass(F)):t.canAddChild&&this.placeholder&&(this.initialPlaceholderPos=i,this._movePlaceholder(t,"after"),this._movePlaceholder({element:this.placeholder.children(c)},"below"))):this.dropTargetNode=null),this.lastLocation=r},_mouseStop:function(e,t){var i,n=this;return this.delayExpandTimer&&(clearTimeout(this.delayExpandTimer),this.delayExpandTimer=null),this._scrollStop(),s.ui.ddmanager&&!t&&s.ui.ddmanager.dragStop(this,e),t||s("body").off(".treeview"),this._deactivate(),this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),s.ui.ddmanager&&!t&&s.ui.ddmanager.drop(this,e)?(this.placeholder&&(this.dragItems.parent().show(),this._removePlaceholder()),this.dragging=!1,this.dragItems=null,this.currentItem=null,this.helper.remove(),this.helper=null,void this._stop(e)):e.target?void(this.options.dragAnimate?(i=this._getAnimation(),this.animating=!0,this.helper.animate(i,J(this.options.dragAnimate)||500,(function(){n._finishDrag(e)}))):this._finishDrag(e)):(this.fromOutside=!1,void(this.dragging=!1))},_scrollCheck:function(e,t){var i,n,o,r=0,l=0,a=this.options,d=this.scrollParent[0];return d&&d!==document&&"HTML"!==d.tagName?(this.overflowOffset.top+d.offsetHeight-e.pageY<a.dragScrollSensitivity?r=a.dragScrollSpeed:e.pageY-this.overflowOffset.top<a.dragScrollSensitivity&&(r=-a.dragScrollSpeed),t&&r&&((i=d.scrollTop+r)<0?(d.scrollTop=0,r=0):i>d.scrollHeight-d.clientHeight?(d.scrollTop=d.scrollHeight-d.clientHeight,r=0):d.scrollTop=i),this.overflowOffset.left+d.offsetWidth-e.pageX<a.dragScrollSensitivity?l=a.dragScrollSpeed:e.pageX-this.overflowOffset.left<a.dragScrollSensitivity&&(l=-a.dragScrollSpeed),t&&l&&((n=d.scrollLeft+l)<0?(d.scrollLeft=0,l=0):n>d.scrollWidth-d.clientWidth?(d.scrollLeft=d.scrollWidth-d.clientWidth,l=0):d.scrollLeft=n),o=!(!l&&!r)):(i=s(document).scrollTop(),n=s(document).scrollLeft(),e.pageY-i<a.dragScrollSensitivity?r=-a.dragScrollSpeed:s(window).height()-(e.pageY-i)<a.dragScrollSensitivity&&(r=a.dragScrollSpeed),t&&r&&((i+=r)<0?(s(document).scrollTop(0),r=0):i>s(document).height()-s(window).height()?(s(document).scrollTop(s(document).height()-s(window).height()),r=0):(e.pageY+=r,s(document).scrollTop(i))),e.pageX-n<a.dragScrollSensitivity?l=-a.dragScrollSpeed:s(window).width()-(e.pageX-n)<a.dragScrollSensitivity&&(l=a.dragScrollSpeed),t&&l&&((n+=l)<0?(s(document).scrollLeft(0),l=0):n+this.helper.width()>s(document).width()-s(window).width()?(s(document).scrollLeft(s(document).width()-s(window).width()-this.helper.width()),l=0):(e.pageX+=l,s(document).scrollLeft(n))),(o=!(!l&&!r))&&t&&(this.position=this._generatePosition(e),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",s.ui.ddmanager&&s.ui.ddmanager.prepareOffsets(this,e))),o},_scrollStart:function(e){var t=this,i=0,n=[150,125,100,99,96,91,84,75,64,51,36];this.scrollTimerId&&this._scrollStop(),function s(){t.scrollTimerId=setTimeout((function(){t._scrollCheck(e,!0)?(t._dragHitCheck(),s()):t._scrollStop()}),n[i]),i<n.length-1&&(i+=1)}()},_scrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_getAnimation:function(){var e,t,i={};return this.placeholder||this.dropTargetNode?(e=this.placeholder?(t=this.placeholder).offset():(t=this.dropTargetNode).offset(),i.left=e.left-this.offset.parent.left-this.margins.left,i.top=e.top-this.offset.parent.top-this.margins.top):(t=this.dragItems.eq(0),e=this.originalPosition,i.left=e.left-this.margins.left,i.top=e.top-this.margins.top,this.scrollParent[0]!==document&&(i.left+=this.originalScroll.left-this.scrollParent[0].scrollLeft,i.top+=this.originalScroll.top-this.scrollParent[0].scrollTop)),-1===this.rtlFactor&&(i.left+=t.width()-this.helper.width()),i},_initPositions:function(e){const t=this,i=t.options.dragReorder,n=t.nodeAdapter;let o,r=[];if(e&&this.dropPositions){let t=e[0].id;for(o=0;o<this.dropPositions.length&&t!==this.dropPositions[o].nodeId;o++);}else r=this.dropPositions=[],e=this.element;let a=[];if(e.find(l).each((function(){const e=s(this);let o=null,h=!1;if(!e.is(D)||e.is("."+g))return;if(i){const i=e.parent().closest(l);i.length?o=t.treeMap[se(i)]:t.options.showRoot||(o=n.root())}else o=t.treeMap[se(e)];const c=t._getDragNodes();if(!i&&"move"===t.dragOperation&&(c.includes(o)||a.includes(e.parent().closest(l)[0])))return void a.push(this);let p=o&&n.allowAdd(o,t.dragOperation,c);i&&(h=n.allowAdd(t.treeMap[se(e)],t.dragOperation,c)),(p||h||e.hasClass(N))&&r.push({canAdd:p,canAddChild:h,element:s(this).children(d),nodeId:this.id,top:0,bottom:0})})),void 0!==o&&r.length)for(let e=0;e<r.length;e++)this.dropPositions.splice(o+e,0,r[e])},_refreshPositions:function(){var e,t,i,n,s;for(e=0;e<this.dropPositions.length;e++)n=(t=this.dropPositions[e]).element.outerHeight(),i=t.element.offset(),t.top=i.top,t.bottom=i.top+n;this.dropPositionsOrigin=0,(s=this.scrollParent)&&s[0]!==document?this.dropPositionsOrigin=s[0].scrollTop:s=this.element,i=s.offset(),this.containerCache.left=i.left,this.containerCache.top=i.top,this.containerCache.width=s.outerWidth(),this.containerCache.height=s.outerHeight()},_makeTempDragItem:function(){var e,i,n,o=t.htmlBuilder();for(o.markup("<li").attr(E,r).markup("><div").attr(E,a).markup("></div><div").attr(E,h).markup(">unseen content</div></li>"),i=s(o.toString()),e=0;e<this.dropPositions.length;e++)if(this.dropPositions[e].canAdd){n=s(this.dropPositions[e].nodeId).parent();break}n||(n=this.element.children("ul")),n.append(i),this.dragItems=i.children(c)},_createPlaceholder:function(e){this.placeholder=s("<li class='"+r+" "+g+"'><div class='"+a+"'></div><div class='"+h+"'>&nbsp;</div></li>"),this.dragItems.first().parent().before(this.placeholder),e&&this.placeholder.height(e)},_movePlaceholder:function(e,t){const i=this,n=i.placeholder.parent(),r=i.nodeAdapter,a=i._getDragNodes();let d=e.element.parent(),h=d[0];if("after"===t&&d.hasClass(I)&&r.allowAdd(i.treeMap[se(d)],i.dragOperation,a)&&(h=d.children("ul").children()[0],t="before"),"above"===t){if(d.next(D).length)return;h=d.parent().parent()[0],d=s(h);let e=d.parent().closest(l),n=null;if(e.length?n=i.treeMap[se(e)]:i.options.showRoot||(n=r.root()),d.hasClass(o)||null===n)return;if(!r.allowAdd(n,i.dragOperation,a))return;t="after"}if("below"===t){let e=d.prevAll(D).first(),t=!1;if(e.hasClass(I)&&(e=e.children("ul").children().last(),t=!0),0===e.length)return;const n=r.allowAdd(i.treeMap[se(e)],i.dragOperation,a);if(!t&&e.hasClass(k)&&n&&this._makeParentIfNeeded(e.children(c)),e.hasClass(N))return void this._expandNode(e,(function(){i._initPositions(e),i._refreshPositions(),n&&e.children("ul")[0].appendChild(i.placeholder[0])}));n&&e[0].parentNode.appendChild(this.placeholder[0])}else"after"!==t||h.nextSibling?h.parentNode.insertBefore(this.placeholder[0],"before"===t?h:h.nextSibling):h.parentNode.appendChild(this.placeholder[0]);0===n.children().length&&this._makeLeafIfNeeded(n.parent().find(c)),this._refreshPositions()},_removePlaceholder:function(){var e=this.placeholder.parent();this.placeholder.remove(),this.placeholder=null,0===e.children().length&&this._makeLeafIfNeeded(e.parent().find(c))},_createHelper:function(e){var t,i=this.options;return"function"==typeof i.dragHelper?t=s(i.dragHelper.apply(this.element[0],[e,this.dragItems])):1===this.dragItems.length?t=this.dragItems.clone().removeAttr("id").removeClass(_):(t=s("<div></div>")).html(this.dragItems.clone().removeClass(_)),t.parents("body").length||t.appendTo("parent"===i.dragAppendTo?this.element[0].parentNode:i.dragAppendTo),/(fixed|absolute)/.test(t.css("position"))||t.css("position","absolute"),t},_adjustOffsetFromHelper:function(e){"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e;return this.offsetParent=this.helper.offsetParent(),e=this.offsetParent[0]===document||this.offsetParent[0]===document.firstElementChild?{left:0,top:0}:this.offsetParent.offset(),this.scrollParent&&this.scrollParent[0]!==document&&s.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&s.ui.ie)&&(e={top:0,left:0}),{top:e.top+(J(this.offsetParent.css("borderTopWidth"))||0),left:e.left+(J(this.offsetParent.css("borderLeftWidth"))||0)}},_generatePosition:function(e){var t=e.pageX,i=e.pageY,n=this.scrollParent&&this.scrollParent[0]!==document&&s.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return this.dragging||this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(t=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(i=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(t=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(i=this.containment[3]+this.offset.click.top)),{top:i-this.offset.click.top-this.offset.parent.top+(o?0:n.scrollTop()),left:t-this.offset.click.left-this.offset.parent.left+(o?0:n.scrollLeft())}},_adjustPositionForScroll:function(){var e=this.position,t=this.scrollParent&&this.scrollParent[0]!==document&&s.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(t[0].tagName);return{top:e.top+this.offset.parent.top-(i?0:t.scrollTop()),left:e.left+this.offset.parent.left-(i?0:t.scrollLeft())}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;"parent"===n.dragContainment&&(n.dragContainment=this.helper[0].parentNode),"document"!==n.dragContainment&&"window"!==n.dragContainment||(this.containment=[0-this.offset.parent.left,0-this.offset.parent.top,s("document"===n.dragContainment?document:window).width()-this.helperProportions.width-this.margins.left,(s("document"===n.dragContainment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.dragContainment)||(e=s(n.dragContainment)[0],t=s(n.dragContainment).offset(),i="hidden"!==s(e).css("overflow"),this.containment=[t.left+(J(s(e).css("borderLeftWidth"))||0)+(J(s(e).css("paddingLeft"))||0)-this.margins.left,t.top+(J(s(e).css("borderTopWidth"))||0)+(J(s(e).css("paddingTop"))||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(J(s(e).css("borderLeftWidth"))||0)-(J(s(e).css("paddingRight"))||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(J(s(e).css("borderTopWidth"))||0)-(J(s(e).css("paddingBottom"))||0)-this.helperProportions.height-this.margins.top])},_intersectsWith:function(e){var t=this.positionAbs.left,i=this.positionAbs.top,n=e.left,s=n+e.width,o=e.top,r=o+e.height,l=this.offset.click.top,a=this.offset.click.left;return i+l>o&&i+l<r&&(t+a>n&&t+a<s)},_dragCopyOrMove:function(e,t){var i,n;e.ctrlKey?i="ctrl":e.altKey?i="alt":e.shiftKey?i="shift":e.metaKey&&(i="meta"),n=this.dragOperations[i]||this.dragOperations.normal,this.dragOperation!==n&&(this.dragOperation=n,this.placeholder&&this.dragItems.parent().toggle("move"!==n),this._initPositions(),this._refreshPositions(),t&&this._trigger("drag",e,this._uiHashDnD()))},_cancel:function(e,t){var i,n=this;function o(){n.animating=!1,n.helper&&n.helper[0].parentNode&&n.helper.remove(),n.helper=null,n.dragging=!1,n.dragItems=null,n.currentItem=null,n._stop(e)}this.dragging&&(this.positionAbs.top=-99999,this._mouseUp(s.Event("mouseup",{target:null})),this.placeholder&&this.dragItems.parent().show()),this.dropTargetNode=null,this.placeholder&&this._removePlaceholder(),this.options.dragAnimate&&!t?(i=this._getAnimation(),this.animating=!0,this.helper.animate(i,J(this.options.dragAnimate)||500,(function(){o()}))):o()},_deactivate:function(){this.element.find("."+F).removeClass(F)},_finishDrag:function(e){const t=this.nodeAdapter;this.animating=!1;let n=this.dropTargetNode,s=0;if(this.placeholder&&(n=this.placeholder.parent().closest(l),this.dragItems.parent().show(),s=ne(this.placeholder),"move"===this.dragOperation&&this.dragItems.parent().hide()),this.fromOutside){if(this.dragItems.parent().remove(),"add"===this.dragOperation&&t.addNode)try{this.placeholder&&this._removePlaceholder(),this._add(e,n.children(c),s,null,!0)}catch(e){i.error("Error in drop add action.",e)}}else if(("copy"===this.dragOperation||"move"===this.dragOperation)&&t.allowAdd&&t["copy"===this.dragOperation?"copyNodes":"moveNodes"]&&("copy"===this.dragOperation||t.allowDelete))try{let i=!0;if("object"==typeof n&&null!==n){let o;o=n.length||this.options.showRoot?this.treeMap[se(n)]:t.root();const r=this._getDragNodes();if(t.allowAdd(o,this.dragOperation,r)&&"move"===this.dragOperation)for(let e=0;e<r.length;e++)if(!t.allowDelete(r[e])){i=!1;break}if(i&&"move"===this.dragOperation)if(this.placeholder){if(this.dragItems.last().closest(l).next()[0]===this.placeholder[0]){i=!1;for(let e=0;e<this.dragItems.length-1;e++)if(this.dragItems.eq(e).closest(l).next()[0]!==this.dragItems.eq(e+1).closest(l)[0]){i=!0;break}}else if(this.dragItems.first().closest(l).prev()[0]===this.placeholder[0]){i=!1;for(let e=1;e<this.dragItems.length;e++)if(this.dragItems.eq(e).closest(l).prev()[0]!==this.dragItems.eq(e-1).closest(l)[0]){i=!0;break}}}else{i=!1;for(let e=0;e<this.dragItems.length;e++)if(this.dragItems.eq(e).closest(l).parent().closest(l)[0]!==n[0]){i=!0;break}}i?(this.placeholder&&this._removePlaceholder(),this._moveOrCopy(e,n.children(c),s,this.dragItems,"copy"===this.dragOperation,!0)):this.dragItems.parent().show()}}catch(e){this.dragItems.parent().show(),i.error("Error in drop "+this.dragOperation+" action.",e)}this.dragging=!1,this._trigger("beforeStop",e,this._uiHashDnD()),this.dragItems=null,this.currentItem=null,this.placeholder&&this._removePlaceholder(),this.helper.remove(),this.helper=null,this.fromOutside&&this._trigger("deactivate",e,this._uiHashDnD(this)),this._stop(e),this.fromOutside=!1},_stop:function(e){apex.tooltipManager&&apex.tooltipManager.enableTooltips(),this._trigger("stop",e,this._uiHashDnD())},_add:function(e,i,n,o,r){var l,a,d=this,h=this.nodeAdapter;i&&i.length?(l=this.treeMap[se(i.parent())],a=re(i,this.labelSelector)+1):(i=null,l=h.root(),a=1),h.addNode(l,n,null,o,(function(o,h){var p,f,u,g=t.htmlBuilder(),m={parentNode:l,parent$:i,node:o,index:h};function v(){d._select(m.node$,e,r),d._trigger("added",e,m)}if(!(!1===o||null===o||h<0)){if(i){if(d._makeParentIfNeeded(i),0===(f=i.parent().children("ul")).length)return void d._expandNode(i.parent(),(function(){f=i.parent().children("ul"),m.node$=f.children().eq(n).children(c),v()}))}else f=d.element.children("ul");d._renderNode(o,a,g),p=s(g.toString()),m.node$=p.children(c),h>=(u=f.children()).length?f.append(p):u.eq(h).before(p),v()}}))},_moveOrCopy:function(e,i,n,o,r,a){var d,h,p=this,f=this.getNodes(o),u=r?"copyNodes":"moveNodes",g=this.nodeAdapter;i&&i.length?(d=this.treeMap[se(i.parent())],h=re(i,this.labelSelector)+1):(i=null,d=g.root(),h=1),g[u](d,n,f,(function(n){var f,u,m,v,_,w,b,y,C=t.htmlBuilder(),x=[],N=[],I={parentNode:d,parent$:i,items:x};function S(){for(f=0;f<x.length;f++)w=x[f],m=g.child(d,w.toIndex),w.toNode=m,C.clear(),p._renderNode(m,h,C),v=s(C.toString()),w.toNode$=v.children(c),y=b.children(D),w.toIndex>=y.length?b.append(v):y.eq(w.toIndex).before(v),N.push(w.toNode$[0]),r||(_=w.fromNode$.parent().parent().closest(l).children(c),w.fromParent$=_,w.fromIndex=w.fromNode$.parent().parent().children().index(w.fromNode$.parent()),w.fromNode$.parent().remove(),p._makeLeafIfNeeded(_));p._select(s(N),e,a),p._trigger(r?"copied":"moved",e,I)}if(n){for(f=0;f<n.length;f++)(u=n[f])>=0&&x.push({fromNode$:o.eq(f),toIndex:u});if(x.sort((function(e,t){return e.toIndex-t.toIndex})),i)return p._makeParentIfNeeded(i),b=i.parent().children("ul"),void p._expandNode(i.parent(),(function(){S()}));b=p.element.children("ul"),S()}}))},_uiHashDnD:function(e){var t=e||this;return{helper:t.helper,placeholder:t.dropTargetNode||t.placeholder||s([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,items:t.dragItems,operation:t.dragOperation,sender:e?e.element:null}},_getDragNodes:function(){let e=[];return this.dragItems&&this.dragItems.length>0&&(e=this.getNodes(this.dragItems),e[0]||(e=[])),e}},apex.widget.contextMenuMixin));const ue={root:function(){return this.data},getLabel:function(e){return e.label},getIcon:function(e){var t=this.getType(e),i=null;return e.icon||null===e.icon?i=e.icon:t.icon||null===t.icon?i=t.icon:void 0!==this.types.default.icon&&(i=this.types.default.icon),i},getClasses:function(e){let t=this.getType(e),i=null;return t.classes?i=t.classes:this.types.default.classes&&(i=this.types.default.classes),e.classes&&(i?i+=" "+e.classes:i=e.classes),i},getLink:function(e){return e.link},getLinkTarget:function(e){return e.linkTarget},isDisabled:function(e){let t=this.getType(e),i=!1;return void 0!==e.isDisabled?i=e.isDisabled:void 0!==t.isDisabled?i=t.isDisabled:void 0!==this.types.default.isDisabled&&(i=this.types.default.isDisabled),i},child:function(e,t){if(e.children)return e.children[t]},childCount:function(e){return e.children?e.children.length:0},hasChildren:function(e){return!!e.children&&e.children.length>0},allowAdd:function(e,t,i){let n,s=this.getType(e),o=!!e.children&&this.check("canAdd",e,t,i);if(o&&i)if("function"==typeof s.validChildren)o=s.validChildren(e,i);else if(void 0!==s.validChildren?n=s.validChildren:void 0!==this.types.default.validChildren&&(n=this.types.default.validChildren),!0!==n)for(let e=0;e<i.length;e++)if(!n.includes(i[e].type)){o=!1;break}return o},allowRename:function(e){return this.check("canRename",e)},allowDelete:function(e){return e!==this.data&&this.check("canDelete",e)},allowDrag:function(e){return this.check("canDrag",e)},dragOperations:function(e){var t,i,n;if(e){if(e.length>0){for(n=e[0].type||"default",t=1;t<e.length;t++)if(e[t].type!==n){n="default";break}}else n="default";i=this.types[n].operations&&void 0!==this.types[n].operations.drag?this.types[n].operations.drag:this.types.default.operations.drag}else i=this.types.default.operations.externalDrag;return i},addNode:function(e,t,i,n,s){var o,r=Q(!0,{},n||this.newNode(e));i&&(r.label=i),this.sortCompare?e.children.push(r):e.children.splice(t,0,r),r._parent=e,void 0!==this._nextId&&(void 0===r.id?r.id=this.nextId():this._nextId+=1),this.sortCompare&&e.children.sort(this.sortCompare),o=e.children.indexOf(r),this.validateAdd(r,o,(function(t){"string"==typeof t||!1===t?(e.children.splice(o,1),s(!1===t&&null)):t&&s(r,o)}))},renameNode:function(e,t,i){var n,s=e.label;e.label=t,e._parent?(this.sortCompare&&e._parent.children.sort(this.sortCompare),n=e._parent.children.indexOf(e)):n=0,this.validateRename(e,n,(function(t){"string"==typeof t||!1===t?(e.label=s,i(!1===t&&null)):t&&i(e,n)}))},deleteNode:function(e,t,i){var n=e._parent,s=e._parent.children.indexOf(e);n.children.splice(s,1),delete e._parent,this.validateDelete(e,i,(function(i){i||(e._parent=n,n.children.splice(s,0,e)),t(i)}))},moveNodes:function(e,t,i,n){var s,o,r,l,a=[];for(s=0;s<i.length;s++)l=(r=(o=i[s])._parent).children.indexOf(o),r.children.splice(l,1),e===r&&l<t&&(t-=1),this.sortCompare?e.children.push(o):(e.children.splice(t,0,o),t+=1),o._parent=e;for(this.sortCompare&&e.children.sort(this.sortCompare),s=0;s<i.length;s++)a[s]=e.children.indexOf(i[s]);this.validateMove(e,i,a,(function(e){n(!!e&&a)}))},copyNodes:function(e,t,i,n){var s,o,r=this,l=[],a=[];function d(e,t){var i,n=Q({},e);if(n._parent=t,void 0!==r._nextId&&(n.id=r.nextId()),e.children)for(n.children=[],i=0;i<e.children.length;i++)n.children.push(d(e.children[i],n));return n}for(s=0;s<i.length;s++)o=d(i[s],e),l[s]=o,this.sortCompare?e.children.push(o):(e.children.splice(t,0,o),a[s]=t,t+=1);if(this.sortCompare)for(e.children.sort(this.sortCompare),s=0;s<l.length;s++)a[s]=e.children.indexOf(l[s]);this.validateCopy(e,l,a,(function(e){n(!!e&&a)}))},sortCompare:function(e,t){return e.label>t.label?1:e.label<t.label?-1:0},nextId:function(){var e=this._nextId;return this._nextId+=1,"tn"+e},newNode:function(e){var t,i={},n=!0,s=this.getType(e);return void 0!==this._nextId&&(i.id=this.nextId()),Array.isArray(s.validChildren)?(i.type=s.validChildren[0],(t=this.types[i.type])&&t.operations&&void 0!==t.operations.canAdd?n=s.operations.canAdd:void 0!==this.types.default.operations.canAdd&&(n=this.types.default.operations.canAdd),t&&void 0!==t.defaultLabel?i.label=t.defaultLabel:void 0!==this.types.default.defaultLabel&&(i.label=this.types.default.defaultLabel)):void 0!==this.types.default.defaultLabel&&(i.label=this.types.default.defaultLabel),n&&(i.children=[]),i},extraCheck:function(e){return e},validateAdd:function(e,t,i){i(!0)},validateRename:function(e,t,i){i(!0)},validateDelete:function(e,t,i){i(!0)},validateMove:function(e,t,i,n){n(!0)},validateCopy:function(e,t,i,n){n(!0)},getType:function(e){var t="default";return e.type&&(t=e.type),this.types[t]||this.types.default},check:function(e,t,i,n){var s=!1,o=this.getType(t);return t.operations&&void 0!==t.operations[e]?s=t.operations[e]:o.operations&&void 0!==o.operations[e]?s=o.operations[e]:void 0!==this.types.default.operations[e]&&(s=this.types.default.operations[e]),"function"==typeof s&&(s=s.call(this,t,i,n)),this.extraCheck(s,e,t,i,n)}};if(s.apex.treeView.makeDefaultNodeAdapter=function(e,t,i,n){let o=Object.create(ue);return Array.isArray(i)&&(n=i,i=!0),null==i&&(i=!0),i&&(s.apex.treeView.addViewStateMixin(o,"id",n),o._nextId=1),o.data=e,o.types=Q(!0,{},{default:{isDisabled:!1,validChildren:!0,operations:{canAdd:!0,canRename:!0,canDelete:!0,canDrag:!0,drag:{normal:"move",ctrl:"copy"},externalDrag:{normal:"add"}}}},t),o.data&&function e(t,n){if(t._parent=n,i&&(o._nextId+=1),t.children)for(let i=0;i<t.children.length;i++)e(t.children[i],t)}(o.data,null),o},s.apex.treeView.makeModelNodeAdapter=function(e,t,i){let n,o;if(!apex.model)throw new Error("Missing module apex.model");return t.shape="tree",n=apex.model.create(e,t,i),o=t.labelField||"label",n._labelKey=n.getFieldKey(o),t.hasIdentity&&s.apex.treeView.addViewStateMixin(n,(function(e){return n.getRecordId(e)}),t.initialExpandedNodeIds),(!i||t.editable||t.visibilityFilter)&&(n.setView=function(t){s.apex.treeView.treeModelListener(e,t)}),n.getType=n._getType,n.getLabel=function(e){return e[this._labelKey]},(t.iconField||t.typeField)&&(t.iconField&&(n._iconKey=n.getFieldKey(t.iconField)),n.getIcon=function(e){let t=this.getType(e),i=this._options,n=null;return this._iconKey&&(e[this._iconKey]||null===e[this._iconKey])?n=e[this._iconKey]:t.icon||null===t.icon?n=t.icon:void 0!==i.types.default.icon&&(n=i.types.default.icon),n}),(t.classesField||t.typeField)&&(t.classesField&&(n._classesKey=n.getFieldKey(t.classesField)),n.getClasses=function(e){let t=this.getType(e),i=this._options,n=null;return t.classes?n=t.classes:i.types.default.classes&&(n=i.types.default.classes),this._classesKey&&e[this._classesKey]&&(n?n+=" "+e[this._classesKey]:n=e[this._classesKey]),n}),n.isHidden=function(e){let t=!1,i=this.getRecordMetadata(this.getRecordId(e));return i&&i.hidden&&(t=!0),t},t.linkField&&(n._linkKey=n.getFieldKey(t.linkField),n.getLink=function(e){return this._linkKey?e[this._linkKey]:null}),t.linkTargetField&&(n._linkTargetKey=n.getFieldKey(t.linkTargetField),n.getLinkTarget=function(e){return this._linkTargetKey?e[this._linkTargetKey]:null}),n.allowRename=n.allowEdit,n.addNode=function(e,t,i,n,s){let o,r,l,a=null,d=this._initRecord(n,null,e);r=e[this._childrenKey],t>=0&&t<r.length&&(a=r[t]),i&&(d[this._labelKey]=i),l=this.insertNewRecord(e,a,d),d=this.getRecord(l),o=r.indexOf(d),s(d,o)},n.renameNode=function(e,t,i){let n,s;this.setValue(e,o,t),s=this.parent(e),n=s?s[this._childrenKey].indexOf(e):0,i(e,n)},n.deleteNode=function(e,t){t(1===this.deleteRecords([e]))},n.moveNodes=function(e,t,i,n){let s,o=[],r=null,l=e[this._childrenKey];(t-=1)>=0&&t<l.length&&(r=l[t]),s=this.moveRecords(i,e,r);for(let e=0;e<s.length;e++){let t=this.getRecord(s[e]);o[e]=l.indexOf(t)}n(o)},n.copyNodes=function(e,t,i,n){let s,o=[],r=null,l=e[this._childrenKey];(t-=1)>=0&&t<l.length&&(r=l[t]),s=this.copyRecords(i,e,r);for(let e=0;e<s.length;e++){let t=this.getRecord(s[e]);o[e]=l.indexOf(t)}n(o)},n},s.apex.treeView.treeModelListener=function(e,t){let i,n=t.data("apex-treeView"),o=n.getNodeAdapter();if(i=n.option("treeModel"),i){i.unSubscribe(n.option("modelViewId"));let t=n.option("modelId");t!==e&&apex.model.release(t),n.option("modelId",null),n.option("treeModel",null),n.option("modelViewId",null)}if(e){if(i=apex.model.get(e),!i)throw new Error("TreeView model not found: "+e);n.option("modelId",e),n.option("treeModel",i),n.option("modelViewId",i.subscribe({onChange:function(e,t){let i;function r(e){let t=[];for(let i=0;i<e.length;i++){let r=o.getViewId(n.baseId,e[i]);null!=r&&t.push(s("#"+n.baseId+r).children(c)[0])}return s(t)}if("refresh"===e)n.refresh();else if("addData"===e)null===t.parentNode&&n.refresh();else if("refreshRecords"===e||"revert"===e);else if("move"===e);else if("copy"===e);else if("insert"===e){const e=o.parent(t.record);o._nodesToRefresh||(o._nodesToRefresh=[]),o._nodesToRefresh.includes(e)||o._nodesToRefresh.push(e),1===o._nodesToRefresh.length&&queueMicrotask((()=>{for(const e of o._nodesToRefresh)e===o.root()?n.refresh():(i=r([e]),n.refresh(i));o._nodesToRefresh.length=null}))}else if("clearChanges"===e);else if("delete"===e){i=r(t.records);for(let e=0;e<t.records.length;e++)o.clearViewId(n.baseId,t.records[e]);n.deleteTreeNodes(i)}else if(("set"===e||"metaChange"===e)&&(i=r([t.record]),i[0])){let s="metaChange"===e&&"hidden"===t.property||"set"===e&&t.field===o._options.classesField;n.update(i,!s)}},progressView:n.element}))}},s.apex.treeView.addViewStateMixin=function(e,t,i){Q(e,{_state:{},isExpanded:function(e,t){return this._getExpandedNodes(e)[this._getIdentity(t)]||!1},setExpanded:function(e,t,i){this._getExpandedNodes(e)[this._getIdentity(t)]=i},getExpandedNodeIds:function(e){var t,i=[],n=this._getExpandedNodes(e);for(t in n)Z(n,t)&&!0===n[t]&&i.push(t);return i},getExpandedState:function(e){var t=this._getExpandedNodes(e);return Q({},t)},getViewId:function(e,t){const i=this._state[e]&&this._state[e].nodeMap;return i&&i[this._getIdentity(t)]},setViewId:function(e,t,i){var n=this._state[e]&&this._state[e].nodeMap;n||(n={},this._state[e]||(this._state[e]={}),this._state[e].nodeMap=n),n[this._getIdentity(t)]=i},clearViewId:function(e,t){var n=this._state[e]&&this._state[e].nodeMap,s=this._state[e]&&this._state[e].expandedNodes;n&&(t?(delete n[this._getIdentity(t)],s&&delete s[this._getIdentity(t)]):(i=this.getExpandedNodeIds(e),this._state[e].nodeMap={},delete this._state[e].expandedNodes))},_getExpandedNodes:function(e){let t=this._state[e]&&this._state[e].expandedNodes;if(!t&&(this._state[e]||(this._state[e]={}),t={},this._state[e].expandedNodes=t,i))for(let e=0;e<i.length;e++)t[i[e]]=!0;return t}}),e._getIdentity||(e._getIdentity="function"==typeof t?t:function(e){return e[t]})},s.ui.draggable&&(s.ui.plugin.add("draggable","connectToTreeView",{start:function(e,t){var n=s(this).data("ui-draggable"),o=n.options,r=Q({},t,{item:n.element});s("body").on("keydown.treeviewplug",(function(e){e.keyCode===s.ui.keyCode.ESCAPE&&(n.dropped=!1,n.cancel())})),n.trees=[],s(o.connectToTreeView).each((function(){var t=s.data(this,"apex-treeView");t&&!t.options.disabled&&t.options.dragAndDrop?(n.trees.push({instance:t}),t._initPositions(),t._refreshPositions(),t._trigger("activate",e,r)):i.warn("Draggable connectToTreeView matches an element that is not a treeView, is disabled, or doesn't support drag and drop.")}))},stop:function(e){var t=s(this).data("ui-draggable");s("body").off(".treeviewplug"),t.trees.forEach((function(i){i.instance.isOver&&!i.invalid?(i.instance.isOver=!1,t.cancelHelperRemoval=!0,i.instance._mouseStop(e,!0),e.target||(i.instance._trigger("deactivate",e,i.instance._uiHashDnD(i.instance)),i.instance.dragItems.parent().remove(),i.instance._cancel(e,!0))):(i.instance._deactivate(),i.instance._trigger("deactivate",e,i.instance._uiHashDnD(i.instance)),i.instance.dragItems&&(i.instance.dragItems.parent().remove(),i.instance._cancel(e,!0)))}))},drag:function(e,t){var i=s(this).data("ui-draggable");for(let s of i.trees){var n=!1;if(!s.invalid)if(s.instance.positionAbs=i.positionAbs,s.instance.helperProportions=i.helperProportions,s.instance.offset.click=i.offset.click,s.instance._intersectsWith(s.instance.containerCache)&&(n=!0),n){if(!s.instance.isOver){if(s.instance.isOver=!0,s.instance._makeTempDragItem(),s.instance.helper=t.helper,s.instance.helper.css("position","relative"),e.target=s.instance.dragItems.parent().children(d)[0],!s.instance._mouseCapture(e,!0)){s.instance.isOver=!1,s.invalid=!0;continue}s.instance._trigger("over",e,s.instance._uiHashDnD(s.instance)),s.instance._mouseStart(e,e,!0),s.instance.offset.click.top=i.offset.click.top,s.instance.offset.click.left=i.offset.click.left,s.instance.offset.parent.left-=i.offset.parent.left-s.instance.offset.parent.left,s.instance.offset.parent.top-=i.offset.parent.top-s.instance.offset.parent.top,i.dropped=s.instance.element,i.currentItem=i.element,s.instance.fromOutside=i}s.instance.dragItems&&s.instance._mouseDrag(e)}else s.instance.isOver&&(s.instance.isOver=!1,s.instance._trigger("out",e,s.instance._uiHashDnD(s.instance)),e.target=null,s.instance._mouseStop(e,!0),s.instance.dragItems.parent().remove(),s.instance.placeholder&&s.instance._removePlaceholder(),i.dropped=!1)}}}),s.ui.plugin.add("draggable","cursor2",{start:function(){var e=s("body"),t=s(this).data("ui-draggable"),i=t.options;i.cursor2&&"auto"!==i.cursor2&&(t.storedCursor=e.css("cursor"),e.css("cursor",i.cursor2),t.storedStylesheet=s("<style>*{ cursor: "+i.cursor2+" !important; }</style>").appendTo(e))},stop:function(){var e=s(this).data("ui-draggable");e.storedCursor&&(s("body").css("cursor",e.storedCursor),e.storedStylesheet.remove())}})),apex.widget){var ge={default:{operations:{canAdd:!1,canDelete:!1,canRename:!1,canDrag:!1}}};apex.widget.tree={init:function(i,n,o,r){var l=s("#"+t.escapeCSS(i),apex.gPageContext$);function a(t,i,n,s){e.plugin(i,{pageItems:n},{dataType:"json",refreshObject:t,loadingIndicator:t,loadingIndicatorPosition:"centered",success:function(e){s(e)}})}function d(e,t){var i;Array.isArray(t)&&t.length>0?e.treeView("setSelectedNodes",t,!1,!0):(i=e.treeView("find",{depth:-1,findAll:!1,match:function(e){return e.id===t}})).length>0&&e.treeView("setSelection",i)}r.regionStaticId&&r.lazyLoading?apex.widget.util.whenBecomesVisible(l,(function(e){!function(e,t,i,n){a(e,i,n,(function(i){var n=i.data||{},o=i.showRoot||!1,r=i.navigation||!1,l=i.hasIdentity||!0,a=Q(!0,{},ge),h=t.initialSelectedNodeId,c=t.nodeHasTooltip;t.defaultIcon&&(a.default.icon=t.defaultIcon),t=Q({getNodeAdapter:function(){return(t.makeNodeAdapter||s.apex.treeView.makeDefaultNodeAdapter)(n,a,l)},tooltip:c?{show:apex.tooltipManager.defaultShowOption(),content:function(e,t){return t?t.tooltip:null}}:null,navigation:r,showRoot:o},t),e.treeView(t),d(e,h)}))}(e,r,r.ajaxIdentifier,r.itemsToSubmit)})):function(e,t,i,n){var o=Q(!0,{},ge),r=t.initialSelectedNodeId,l=t.nodeHasTooltip;t.defaultIcon&&(o.default.icon=t.defaultIcon);t=Q({getNodeAdapter:function(){return(t.makeNodeAdapter||s.apex.treeView.makeDefaultNodeAdapter)(i,o,n)},tooltip:l?{show:apex.tooltipManager.defaultShowOption(),content:function(e,t){return t?t.tooltip:null}}:null,navigation:!0},t),e.treeView(t),d(e,r)}(l,r,n,o),r.regionStaticId&&apex.region.create(r.regionStaticId,{type:"Tree",widgetName:"treeView",refresh:function(){var e,t,i;e=l,t=r.ajaxIdentifier,i=r.itemsToSubmit,a(e,t,i,(function(t){var i,n=t.data||{},o=t.showRoot||!1,r=t.navigation||!1,l=t.hasIdentity||!0,a=e.treeView("getNodeAdapter"),h=function(e){return e.treeView("getSelectedNodes")}(e);a.getExpandedState?i=e.treeView("getExpandedNodeIds"):s.apex.treeView.addViewStateMixin(a,l,h),a.data=n,e.treeView("getNodeAdapter",(function(){return a})),e.treeView("option","showRoot",o),e.treeView("option","navigation",r),e.treeView("refresh"),function(e,t){if(t)for(let i=0;i<t.length;i++){let n=e.treeView("find",{depth:-1,findAll:!1,match:function(e){return e.id===t[i]}});n.length>0&&e.treeView("expand",n)}}(e,i),d(e,h)}))},focus:function(){l.treeView("focus")},widget:function(){return l}})},expand_all:function(e){s("#"+t.escapeCSS(e),apex.gPageContext$).treeView("expandAll")},collapse_all:function(e){s("#"+t.escapeCSS(e),apex.gPageContext$).treeView("collapseAll")},reset:function(e){var i=s("#"+t.escapeCSS(e),apex.gPageContext$);i.treeView("collapseAll").treeView("expand",i.children().children("li").first())}}}}(apex.server,apex.util,apex.debug,apex.actions,apex.jQuery);